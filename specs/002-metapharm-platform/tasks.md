# Implementation Tasks: MetaPharm Connect Healthcare Platform

**Branch**: `002-metapharm-platform`
**Date**: 2025-11-07
**Generated By**: `/speckit.tasks` command
**Scope**: MVP (P1-P3) - Prescription Processing, Teleconsultation, Inventory Management

---

## Task Format

```
- [ ] [TaskID] [Priority] [Story] Description with file path
```

**Priority**: `P` (Must have), `S` (Should have), `C` (Could have)
**Story**: `US1` (User Story 1), `US2` (User Story 2), etc.

---

## Phase 1: Project Setup & Infrastructure

### Repository & Build Configuration

- [ ] [T001] [P] [Setup] Initialize monorepo structure with npm workspaces at repository root
- [ ] [T002] [P] [Setup] Create backend/package.json with TypeScript 5.3 and Node.js 20 LTS configuration
- [ ] [T003] [P] [Setup] Create mobile/package.json with React Native 0.73 workspace configuration
- [ ] [T004] [P] [Setup] Create web/package.json with React 18 workspace configuration
- [ ] [T005] [P] [Setup] Create packages/api-types/package.json for shared TypeScript types
- [ ] [T006] [P] [Setup] Configure TypeScript compiler in backend/tsconfig.json with strict mode
- [ ] [T007] [P] [Setup] Configure ESLint and Prettier in .eslintrc.json for code quality
- [ ] [T008] [P] [Setup] Create .gitignore with Node.js, React Native, and IDE patterns
- [ ] [T009] [P] [Setup] Create .env.example files in backend/, mobile/, and web/ directories
- [ ] [T010] [P] [Setup] Configure Jest test runner in backend/jest.config.js
- [ ] [T011] [P] [Setup] Configure Jest for React Native in mobile/jest.config.js
- [ ] [T012] [P] [Setup] Configure Jest for React in web/jest.config.js

### Docker & Local Development

- [ ] [T013] [P] [Setup] Create infrastructure/docker/docker-compose.yml with PostgreSQL 16, Redis 7
- [ ] [T014] [P] [Setup] Add API Gateway container to docker-compose.yml on port 4000
- [ ] [T015] [P] [Setup] Add Auth Service container to docker-compose.yml on port 4001
- [ ] [T016] [P] [Setup] Add Prescription Service container to docker-compose.yml on port 4002
- [ ] [T017] [P] [Setup] Add Teleconsultation Service container to docker-compose.yml on port 4003
- [ ] [T018] [P] [Setup] Add Inventory Service container to docker-compose.yml on port 4004
- [ ] [T019] [P] [Setup] Add Notification Service container to docker-compose.yml on port 4005
- [ ] [T020] [P] [Setup] Create Dockerfile for backend services in backend/Dockerfile
- [ ] [T021] [P] [Setup] Create docker-compose.override.yml for local development overrides

### CI/CD Pipeline

- [ ] [T022] [S] [Setup] Create .github/workflows/backend-tests.yml for backend CI
- [ ] [T023] [S] [Setup] Create .github/workflows/mobile-tests.yml for mobile CI
- [ ] [T024] [S] [Setup] Create .github/workflows/web-tests.yml for web CI
- [ ] [T025] [C] [Setup] Create .github/workflows/deploy-staging.yml for staging deployment
- [ ] [T026] [C] [Setup] Configure k6 load testing in .github/workflows/load-tests.yml

---

## Phase 2: Foundational Services

### Database Setup

- [ ] [T027] [P] [Foundation] Create database migration tool in backend/shared/db/migrate.ts using node-pg-migrate
- [ ] [T028] [P] [Foundation] Create initial migration backend/shared/db/migrations/001_create_users.sql with User table
- [ ] [T029] [P] [Foundation] Create migration backend/shared/db/migrations/002_create_pharmacies.sql with Pharmacy table
- [ ] [T030] [P] [Foundation] Create migration backend/shared/db/migrations/003_create_audit_trail.sql with AuditTrailEntry table
- [ ] [T031] [P] [Foundation] Implement Row-Level Security policies in backend/shared/db/migrations/004_enable_rls.sql
- [ ] [T032] [P] [Foundation] Create seed script backend/shared/db/seeds/dev-seed.ts with test users and pharmacies
- [ ] [T033] [P] [Foundation] Create TypeORM entities in backend/shared/models/User.ts matching schema
- [ ] [T034] [P] [Foundation] Create TypeORM entity in backend/shared/models/Pharmacy.ts
- [ ] [T035] [P] [Foundation] Create TypeORM entity in backend/shared/models/AuditTrailEntry.ts

### Encryption & Security

- [ ] [T036] [P] [Foundation] Implement AWS KMS encryption utility in backend/shared/utils/encryption.ts
- [ ] [T037] [P] [Foundation] Create encryptField() function with data key caching in backend/shared/utils/encryption.ts
- [ ] [T038] [P] [Foundation] Create decryptField() function in backend/shared/utils/encryption.ts
- [ ] [T039] [P] [Foundation] Implement password hashing with bcrypt in backend/shared/utils/auth.ts
- [ ] [T040] [P] [Foundation] Create JWT token generation function in backend/shared/utils/jwt.ts
- [ ] [T041] [P] [Foundation] Create JWT token validation middleware in backend/shared/middleware/auth.ts
- [ ] [T042] [P] [Foundation] Implement RBAC permission checking in backend/shared/middleware/rbac.ts

### Auth Service

- [ ] [T043] [P] [Foundation] Initialize Auth Service in backend/services/auth-service/src/index.ts
- [ ] [T044] [P] [Foundation] Create POST /auth/login endpoint in backend/services/auth-service/src/routes/login.ts
- [ ] [T045] [P] [Foundation] Implement email/password authentication in backend/services/auth-service/src/controllers/loginController.ts
- [ ] [T046] [P] [Foundation] Create POST /auth/mfa/verify endpoint in backend/services/auth-service/src/routes/mfa.ts
- [ ] [T047] [P] [Foundation] Implement TOTP MFA verification in backend/services/auth-service/src/controllers/mfaController.ts
- [ ] [T048] [S] [Foundation] Integrate HIN e-ID OAuth in backend/services/auth-service/src/integrations/hin-eid.ts
- [ ] [T049] [P] [Foundation] Create GET /auth/sessions endpoint in backend/services/auth-service/src/routes/sessions.ts
- [ ] [T050] [P] [Foundation] Create DELETE /auth/logout endpoint in backend/services/auth-service/src/routes/logout.ts
- [ ] [T051] [P] [Foundation] Write unit tests for Auth Service in backend/services/auth-service/__tests__/

### API Gateway

- [ ] [T052] [P] [Foundation] Initialize API Gateway in backend/services/api-gateway/src/index.ts with Express
- [ ] [T053] [P] [Foundation] Implement rate limiting middleware in backend/services/api-gateway/src/middleware/rateLimiter.ts
- [ ] [T054] [P] [Foundation] Implement request routing to microservices in backend/services/api-gateway/src/routes/proxy.ts
- [ ] [T055] [P] [Foundation] Add JWT validation middleware to API Gateway in backend/services/api-gateway/src/middleware/auth.ts
- [ ] [T056] [P] [Foundation] Implement CORS configuration in backend/services/api-gateway/src/middleware/cors.ts
- [ ] [T057] [P] [Foundation] Add request logging middleware in backend/services/api-gateway/src/middleware/logger.ts
- [ ] [T058] [P] [Foundation] Create health check endpoint GET /health in backend/services/api-gateway/src/routes/health.ts

### Audit Trail Service

- [ ] [T059] [P] [Foundation] Create audit trail logging utility in backend/shared/utils/audit.ts
- [ ] [T060] [P] [Foundation] Implement logAuditEvent() function with immutable insert in backend/shared/utils/audit.ts
- [ ] [T061] [P] [Foundation] Create database trigger for Prescription auditing in backend/shared/db/migrations/005_audit_triggers.sql
- [ ] [T062] [P] [Foundation] Create database trigger for Teleconsultation auditing in backend/shared/db/migrations/005_audit_triggers.sql
- [ ] [T063] [P] [Foundation] Create GET /audit/entries endpoint in backend/services/api-gateway/src/routes/audit.ts

### Notification Service

- [ ] [T064] [P] [Foundation] Initialize Notification Service in backend/services/notification-service/src/index.ts
- [ ] [T065] [P] [Foundation] Integrate Twilio SendGrid for email in backend/services/notification-service/src/integrations/email.ts
- [ ] [T066] [P] [Foundation] Integrate Twilio SMS API in backend/services/notification-service/src/integrations/sms.ts
- [ ] [T067] [P] [Foundation] Create sendEmail() function in backend/services/notification-service/src/controllers/emailController.ts
- [ ] [T068] [P] [Foundation] Create sendSMS() function in backend/services/notification-service/src/controllers/smsController.ts
- [ ] [T069] [P] [Foundation] Implement push notification queue consumer in backend/services/notification-service/src/workers/pushWorker.ts
- [ ] [T070] [S] [Foundation] Integrate Firebase Cloud Messaging for mobile push in backend/services/notification-service/src/integrations/fcm.ts

---

## Phase 3: User Story 1 - Prescription Processing & Validation (P1)

### Database Schema

- [ ] [T071] [P] [US1] Create migration backend/shared/db/migrations/010_create_prescriptions.sql with Prescription table
- [ ] [T072] [P] [US1] Create migration backend/shared/db/migrations/011_create_prescription_items.sql with PrescriptionItem table
- [ ] [T073] [P] [US1] Create migration backend/shared/db/migrations/012_create_treatment_plans.sql with TreatmentPlan table
- [ ] [T074] [P] [US1] Create TypeORM entity in backend/shared/models/Prescription.ts with RLS policy
- [ ] [T075] [P] [US1] Create TypeORM entity in backend/shared/models/PrescriptionItem.ts
- [ ] [T076] [P] [US1] Create TypeORM entity in backend/shared/models/TreatmentPlan.ts

### Prescription Service - Backend

- [ ] [T077] [P] [US1] Initialize Prescription Service in backend/services/prescription-service/src/index.ts
- [ ] [T078] [P] [US1] Create POST /prescriptions endpoint in backend/services/prescription-service/src/routes/prescriptions.ts
- [ ] [T079] [P] [US1] Implement image upload to S3 in backend/services/prescription-service/src/controllers/uploadController.ts
- [ ] [T080] [P] [US1] Create POST /prescriptions/:id/transcribe endpoint in backend/services/prescription-service/src/routes/transcribe.ts
- [ ] [T081] [P] [US1] Integrate AWS Textract for OCR in backend/services/prescription-service/src/integrations/textract.ts
- [ ] [T082] [P] [US1] Implement AI confidence scoring in backend/services/prescription-service/src/utils/aiConfidence.ts
- [ ] [T083] [P] [US1] Implement low-confidence field highlighting (FR-013a) in backend/services/prescription-service/src/utils/confidence.ts
- [ ] [T084] [P] [US1] Create POST /prescriptions/:id/validate endpoint in backend/services/prescription-service/src/routes/validate.ts
- [ ] [T085] [P] [US1] Integrate FDB MedKnowledge API for drug interactions in backend/services/prescription-service/src/integrations/fdb.ts
- [ ] [T086] [P] [US1] Implement allergy checking against patient record in backend/services/prescription-service/src/utils/allergyCheck.ts
- [ ] [T087] [P] [US1] Implement contraindication checking in backend/services/prescription-service/src/utils/contraindications.ts
- [ ] [T088] [P] [US1] Create PUT /prescriptions/:id/approve endpoint in backend/services/prescription-service/src/routes/approve.ts
- [ ] [T089] [P] [US1] Implement pharmacist approval logic in backend/services/prescription-service/src/controllers/approveController.ts
- [ ] [T090] [P] [US1] Create PUT /prescriptions/:id/reject endpoint in backend/services/prescription-service/src/routes/reject.ts
- [ ] [T091] [P] [US1] Implement treatment plan generation in backend/services/prescription-service/src/utils/treatmentPlan.ts
- [ ] [T092] [P] [US1] Create GET /prescriptions endpoint with filtering in backend/services/prescription-service/src/routes/list.ts
- [ ] [T093] [P] [US1] Implement prescription state machine in backend/services/prescription-service/src/utils/stateMachine.ts
- [ ] [T094] [P] [US1] Write unit tests for prescription validation in backend/services/prescription-service/__tests__/validate.test.ts
- [ ] [T095] [P] [US1] Write integration tests for prescription workflow in backend/services/prescription-service/__tests__/integration/workflow.test.ts

### Prescription - Mobile (Patient App)

- [ ] [T096] [P] [US1] Initialize Patient App in mobile/patient-app/src/App.tsx
- [ ] [T097] [P] [US1] Create Prescription Upload screen in mobile/patient-app/src/screens/PrescriptionUploadScreen.tsx
- [ ] [T098] [P] [US1] Implement camera integration for prescription photo in mobile/patient-app/src/components/CameraCapture.tsx
- [ ] [T099] [P] [US1] Implement image picker for prescription upload in mobile/patient-app/src/components/ImagePicker.tsx
- [ ] [T100] [P] [US1] Create Prescription List screen in mobile/patient-app/src/screens/PrescriptionListScreen.tsx
- [ ] [T101] [P] [US1] Create Prescription Detail screen in mobile/patient-app/src/screens/PrescriptionDetailScreen.tsx
- [ ] [T102] [P] [US1] Implement prescription API client in mobile/patient-app/src/services/prescriptionService.ts
- [ ] [T103] [P] [US1] Create Redux slice for prescriptions in mobile/patient-app/src/store/prescriptionSlice.ts
- [ ] [T104] [P] [US1] Implement prescription status badge component in mobile/patient-app/src/components/PrescriptionStatusBadge.tsx

### Prescription - Mobile (Pharmacist App)

- [ ] [T105] [P] [US1] Initialize Pharmacist App in mobile/pharmacist-app/src/App.tsx
- [ ] [T106] [P] [US1] Create Prescription Queue screen in mobile/pharmacist-app/src/screens/PrescriptionQueueScreen.tsx
- [ ] [T107] [P] [US1] Create Prescription Review screen in mobile/pharmacist-app/src/screens/PrescriptionReviewScreen.tsx
- [ ] [T108] [P] [US1] Implement AI transcription editor with confidence indicators in mobile/pharmacist-app/src/components/TranscriptionEditor.tsx
- [ ] [T109] [P] [US1] Implement low-confidence field warnings in mobile/pharmacist-app/src/components/ConfidenceWarning.tsx
- [ ] [T110] [P] [US1] Implement drug interaction warnings display in mobile/pharmacist-app/src/components/InteractionWarnings.tsx
- [ ] [T111] [P] [US1] Create Approve/Reject action buttons in mobile/pharmacist-app/src/components/PrescriptionActions.tsx
- [ ] [T112] [P] [US1] Implement messaging to doctor from prescription context in mobile/pharmacist-app/src/screens/DoctorMessageScreen.tsx
- [ ] [T113] [P] [US1] Create prescription API client in mobile/pharmacist-app/src/services/prescriptionService.ts
- [ ] [T114] [P] [US1] Create Redux slice for prescription queue in mobile/pharmacist-app/src/store/queueSlice.ts

### Prescription - Web (Pharmacist Portal)

- [ ] [T115] [P] [US1] Create Prescription Dashboard in web/src/apps/pharmacist/pages/PrescriptionDashboard.tsx
- [ ] [T116] [P] [US1] Create Prescription Review page in web/src/apps/pharmacist/pages/PrescriptionReview.tsx
- [ ] [T117] [P] [US1] Implement DataGrid for prescription queue in web/src/apps/pharmacist/components/PrescriptionQueue.tsx
- [ ] [T118] [P] [US1] Implement AI transcription editor in web/src/apps/pharmacist/components/TranscriptionEditor.tsx
- [ ] [T119] [P] [US1] Implement safety warnings panel in web/src/apps/pharmacist/components/SafetyWarnings.tsx
- [ ] [T120] [P] [US1] Create prescription API hooks in web/src/shared/hooks/usePrescriptions.ts
- [ ] [T121] [P] [US1] Implement prescription status filters in web/src/apps/pharmacist/components/StatusFilters.tsx

### Prescription - Mobile (Doctor App)

- [ ] [T122] [S] [US1] Initialize Doctor App in mobile/doctor-app/src/App.tsx
- [ ] [T123] [S] [US1] Create Prescription Creation screen in mobile/doctor-app/src/screens/CreatePrescriptionScreen.tsx
- [ ] [T124] [S] [US1] Implement drug search with AI suggestions in mobile/doctor-app/src/components/DrugSearch.tsx
- [ ] [T125] [S] [US1] Implement dosage picker in mobile/doctor-app/src/components/DosagePicker.tsx
- [ ] [T126] [S] [US1] Create patient selector in mobile/doctor-app/src/components/PatientSelector.tsx
- [ ] [T127] [S] [US1] Create pharmacy selector in mobile/doctor-app/src/components/PharmacySelector.tsx
- [ ] [T128] [S] [US1] Implement prescription send confirmation in mobile/doctor-app/src/screens/SendConfirmationScreen.tsx

### Testing & QA

- [ ] [T129] [P] [US1] Write E2E test for patient prescription upload workflow in backend/tests/e2e/prescription-upload.test.ts
- [ ] [T130] [P] [US1] Write E2E test for pharmacist prescription review workflow in backend/tests/e2e/prescription-review.test.ts
- [ ] [T131] [P] [US1] Write contract test for Prescription API in backend/tests/contract/prescription-api.test.ts
- [ ] [T132] [P] [US1] Perform load test for prescription submission (target: 1000/hour) using k6

---

## Phase 4: User Story 2 - Secure Teleconsultation (P2)

### Database Schema

- [ ] [T133] [P] [US2] Create migration backend/shared/db/migrations/020_create_teleconsultations.sql with Teleconsultation table
- [ ] [T134] [P] [US2] Create migration backend/shared/db/migrations/021_create_consultation_notes.sql with ConsultationNote table
- [ ] [T135] [P] [US2] Create TypeORM entity in backend/shared/models/Teleconsultation.ts with RLS
- [ ] [T136] [P] [US2] Create TypeORM entity in backend/shared/models/ConsultationNote.ts

### Teleconsultation Service - Backend

- [ ] [T137] [P] [US2] Initialize Teleconsultation Service in backend/services/teleconsultation-service/src/index.ts
- [ ] [T138] [P] [US2] Create GET /teleconsultations/availability endpoint in backend/services/teleconsultation-service/src/routes/availability.ts
- [ ] [T139] [P] [US2] Implement pharmacist availability checking in backend/services/teleconsultation-service/src/controllers/availabilityController.ts
- [ ] [T140] [P] [US2] Create POST /teleconsultations endpoint in backend/services/teleconsultation-service/src/routes/book.ts
- [ ] [T141] [P] [US2] Implement booking validation and conflict checking in backend/services/teleconsultation-service/src/controllers/bookController.ts
- [ ] [T142] [P] [US2] Integrate Twilio Video Rooms API in backend/services/teleconsultation-service/src/integrations/twilio.ts
- [ ] [T143] [P] [US2] Create GET /teleconsultations/:id/join endpoint in backend/services/teleconsultation-service/src/routes/join.ts
- [ ] [T144] [P] [US2] Implement Twilio access token generation in backend/services/teleconsultation-service/src/controllers/joinController.ts
- [ ] [T145] [P] [US2] Create POST /teleconsultations/:id/notes endpoint in backend/services/teleconsultation-service/src/routes/notes.ts
- [ ] [T146] [P] [US2] Implement AI transcription with Twilio speech-to-text in backend/services/teleconsultation-service/src/integrations/transcription.ts
- [ ] [T147] [P] [US2] Implement consultation note editing with audit trail (FR-025a) in backend/services/teleconsultation-service/src/controllers/notesController.ts
- [ ] [T148] [P] [US2] Implement recording consent management in backend/services/teleconsultation-service/src/utils/consent.ts
- [ ] [T149] [P] [US2] Create teleconsultation state machine in backend/services/teleconsultation-service/src/utils/stateMachine.ts
- [ ] [T150] [P] [US2] Implement appointment reminder notifications in backend/services/teleconsultation-service/src/workers/reminderWorker.ts
- [ ] [T151] [P] [US2] Write unit tests for booking logic in backend/services/teleconsultation-service/__tests__/booking.test.ts

### Teleconsultation - Mobile (Patient App)

- [ ] [T152] [P] [US2] Create Teleconsultation Booking screen in mobile/patient-app/src/screens/BookTeleconsultationScreen.tsx
- [ ] [T153] [P] [US2] Implement availability calendar in mobile/patient-app/src/components/AvailabilityCalendar.tsx
- [ ] [T154] [P] [US2] Create Video Call screen in mobile/patient-app/src/screens/VideoCallScreen.tsx
- [ ] [T155] [P] [US2] Integrate Twilio Video SDK in mobile/patient-app/src/components/TwilioVideo.tsx
- [ ] [T156] [P] [US2] Implement video controls (mute, video on/off, end call) in mobile/patient-app/src/components/VideoControls.tsx
- [ ] [T157] [P] [US2] Implement audio-only fallback in mobile/patient-app/src/components/AudioFallback.tsx
- [ ] [T158] [P] [US2] Create recording consent prompt in mobile/patient-app/src/components/RecordingConsent.tsx
- [ ] [T159] [P] [US2] Create Upcoming Consultations list in mobile/patient-app/src/screens/UpcomingConsultationsScreen.tsx
- [ ] [T160] [P] [US2] Implement teleconsultation API client in mobile/patient-app/src/services/teleconsultationService.ts
- [ ] [T161] [P] [US2] Create Redux slice for teleconsultations in mobile/patient-app/src/store/teleconsultationSlice.ts

### Teleconsultation - Mobile (Pharmacist App)

- [ ] [T162] [P] [US2] Create Consultation Dashboard in mobile/pharmacist-app/src/screens/ConsultationDashboardScreen.tsx
- [ ] [T163] [P] [US2] Create Video Call screen in mobile/pharmacist-app/src/screens/PharmacistVideoCallScreen.tsx
- [ ] [T164] [P] [US2] Implement patient medical record sidebar in mobile/pharmacist-app/src/components/PatientRecordSidebar.tsx
- [ ] [T165] [P] [US2] Implement AI-assisted note-taking in mobile/pharmacist-app/src/components/ConsultationNotes.tsx
- [ ] [T166] [P] [US2] Implement transcript editing with audit trail in mobile/pharmacist-app/src/components/TranscriptEditor.tsx
- [ ] [T167] [P] [US2] Create prescription creation from consultation in mobile/pharmacist-app/src/screens/ConsultationPrescriptionScreen.tsx
- [ ] [T168] [P] [US2] Implement consultation status tracking in mobile/pharmacist-app/src/components/ConsultationStatus.tsx

### Teleconsultation - Web (Pharmacist/Patient Portals)

- [ ] [T169] [P] [US2] Create Teleconsultation Calendar in web/src/apps/pharmacist/pages/ConsultationCalendar.tsx
- [ ] [T170] [P] [US2] Create Video Call page in web/src/apps/pharmacist/pages/VideoCall.tsx
- [ ] [T171] [P] [US2] Integrate Twilio Video in web/src/shared/components/TwilioVideoRoom.tsx
- [ ] [T172] [P] [US2] Implement patient record sidebar in web/src/apps/pharmacist/components/PatientRecordPanel.tsx
- [ ] [T173] [P] [US2] Create consultation notes editor in web/src/apps/pharmacist/components/NotesEditor.tsx
- [ ] [T174] [P] [US2] Create teleconsultation hooks in web/src/shared/hooks/useTeleconsultation.ts

### Testing & QA

- [ ] [T175] [P] [US2] Write E2E test for patient booking workflow in backend/tests/e2e/teleconsultation-booking.test.ts
- [ ] [T176] [P] [US2] Write E2E test for video call session in backend/tests/e2e/video-call.test.ts
- [ ] [T177] [P] [US2] Write integration test for Twilio Video integration in backend/services/teleconsultation-service/__tests__/twilio.test.ts
- [ ] [T178] [P] [US2] Perform load test for concurrent video calls (target: 100 concurrent) using k6

---

## Phase 5: User Story 3 - Real-Time Inventory Management (P3)

### Database Schema

- [ ] [T179] [P] [US3] Create migration backend/shared/db/migrations/030_create_inventory_items.sql with InventoryItem table
- [ ] [T180] [P] [US3] Create migration backend/shared/db/migrations/031_create_inventory_transactions.sql with InventoryTransaction table
- [ ] [T181] [P] [US3] Create migration backend/shared/db/migrations/032_create_inventory_alerts.sql with InventoryAlert table
- [ ] [T182] [P] [US3] Create TypeORM entity in backend/shared/models/InventoryItem.ts with RLS
- [ ] [T183] [P] [US3] Create TypeORM entity in backend/shared/models/InventoryTransaction.ts
- [ ] [T184] [P] [US3] Create TypeORM entity in backend/shared/models/InventoryAlert.ts

### Inventory Service - Backend

- [ ] [T185] [P] [US3] Initialize Inventory Service in backend/services/inventory-service/src/index.ts
- [ ] [T186] [P] [US3] Create POST /inventory/scan endpoint in backend/services/inventory-service/src/routes/scan.ts
- [ ] [T187] [P] [US3] Implement QR code parsing in backend/services/inventory-service/src/utils/qrParser.ts
- [ ] [T188] [P] [US3] Implement stock update logic in backend/services/inventory-service/src/controllers/scanController.ts
- [ ] [T189] [P] [US3] Create inventory transaction recording in backend/services/inventory-service/src/controllers/transactionController.ts
- [ ] [T190] [P] [US3] Create GET /inventory/items endpoint in backend/services/inventory-service/src/routes/items.ts
- [ ] [T191] [P] [US3] Create PUT /inventory/items/:id endpoint in backend/services/inventory-service/src/routes/update.ts
- [ ] [T192] [P] [US3] Create GET /inventory/alerts endpoint in backend/services/inventory-service/src/routes/alerts.ts
- [ ] [T193] [P] [US3] Implement low stock alert generation in backend/services/inventory-service/src/workers/alertWorker.ts
- [ ] [T194] [P] [US3] Implement expiration alert generation in backend/services/inventory-service/src/workers/expirationWorker.ts
- [ ] [T195] [P] [US3] Integrate AWS Forecast for demand prediction in backend/services/inventory-service/src/integrations/forecast.ts
- [ ] [T196] [P] [US3] Implement AI-suggested reorder quantities in backend/services/inventory-service/src/utils/reorderSuggestion.ts
- [ ] [T197] [P] [US3] Implement controlled substance tracking in backend/services/inventory-service/src/utils/controlledSubstance.ts
- [ ] [T198] [P] [US3] Create inventory analytics endpoint GET /inventory/analytics in backend/services/inventory-service/src/routes/analytics.ts
- [ ] [T199] [P] [US3] Write unit tests for stock calculations in backend/services/inventory-service/__tests__/stock.test.ts

### Inventory - Mobile (Pharmacist App)

- [ ] [T200] [P] [US3] Create Inventory Dashboard in mobile/pharmacist-app/src/screens/InventoryDashboardScreen.tsx
- [ ] [T201] [P] [US3] Create QR Scanner screen in mobile/pharmacist-app/src/screens/QRScannerScreen.tsx
- [ ] [T202] [P] [US3] Integrate React Native Camera for QR scanning in mobile/pharmacist-app/src/components/QRScanner.tsx
- [ ] [T203] [P] [US3] Create Inventory Alerts screen in mobile/pharmacist-app/src/screens/InventoryAlertsScreen.tsx
- [ ] [T204] [P] [US3] Create Inventory Item Detail screen in mobile/pharmacist-app/src/screens/InventoryItemScreen.tsx
- [ ] [T205] [P] [US3] Implement stock level indicators in mobile/pharmacist-app/src/components/StockLevelBadge.tsx
- [ ] [T206] [P] [US3] Create Restock Suggestions panel in mobile/pharmacist-app/src/components/RestockSuggestions.tsx
- [ ] [T207] [P] [US3] Implement batch info editor in mobile/pharmacist-app/src/components/BatchInfoEditor.tsx
- [ ] [T208] [P] [US3] Create inventory API client in mobile/pharmacist-app/src/services/inventoryService.ts
- [ ] [T209] [P] [US3] Create Redux slice for inventory in mobile/pharmacist-app/src/store/inventorySlice.ts

### Inventory - Web (Pharmacist Portal)

- [ ] [T210] [P] [US3] Create Inventory Management page in web/src/apps/pharmacist/pages/InventoryManagement.tsx
- [ ] [T211] [P] [US3] Create Inventory DataGrid in web/src/apps/pharmacist/components/InventoryTable.tsx
- [ ] [T212] [P] [US3] Implement inventory search and filters in web/src/apps/pharmacist/components/InventoryFilters.tsx
- [ ] [T213] [P] [US3] Create Alerts Dashboard in web/src/apps/pharmacist/pages/InventoryAlerts.tsx
- [ ] [T214] [P] [US3] Create Batch Management modal in web/src/apps/pharmacist/components/BatchModal.tsx
- [ ] [T215] [P] [US3] Implement multi-location inventory view in web/src/apps/pharmacist/components/MultiLocationInventory.tsx
- [ ] [T216] [P] [US3] Create inventory analytics charts in web/src/apps/pharmacist/components/InventoryCharts.tsx
- [ ] [T217] [P] [US3] Create inventory hooks in web/src/shared/hooks/useInventory.ts

### Testing & QA

- [ ] [T218] [P] [US3] Write E2E test for QR scanning workflow in backend/tests/e2e/inventory-scanning.test.ts
- [ ] [T219] [P] [US3] Write E2E test for alert generation in backend/tests/e2e/inventory-alerts.test.ts
- [ ] [T220] [P] [US3] Write integration test for forecast integration in backend/services/inventory-service/__tests__/forecast.test.ts
- [ ] [T221] [P] [US3] Perform load test for inventory updates (target: 5000 scans/hour) using k6

---

## Phase 6: Polish & Cross-Cutting Concerns

### Shared Mobile Components

- [ ] [T222] [P] [Shared] Create Navigation configuration in mobile/shared/navigation/RootNavigator.tsx
- [ ] [T223] [P] [Shared] Create Auth navigation in mobile/shared/navigation/AuthNavigator.tsx
- [ ] [T224] [P] [Shared] Create shared Button component in mobile/shared/components/Button.tsx
- [ ] [T225] [P] [Shared] Create shared Input component in mobile/shared/components/Input.tsx
- [ ] [T226] [P] [Shared] Create shared Card component in mobile/shared/components/Card.tsx
- [ ] [T227] [P] [Shared] Create shared Loading indicator in mobile/shared/components/Loading.tsx
- [ ] [T228] [P] [Shared] Create shared Error boundary in mobile/shared/components/ErrorBoundary.tsx
- [ ] [T229] [P] [Shared] Create API client utility in mobile/shared/services/apiClient.ts
- [ ] [T230] [P] [Shared] Implement offline queue in mobile/shared/services/offlineQueue.ts
- [ ] [T231] [P] [Shared] Create secure storage utility in mobile/shared/utils/secureStorage.ts

### Shared Web Components

- [ ] [T232] [P] [Shared] Create App Shell in web/src/shared/components/AppShell.tsx
- [ ] [T233] [P] [Shared] Create Navigation menu in web/src/shared/components/Navigation.tsx
- [ ] [T234] [P] [Shared] Create shared DataGrid component in web/src/shared/components/DataGrid.tsx
- [ ] [T235] [P] [Shared] Create shared Modal component in web/src/shared/components/Modal.tsx
- [ ] [T236] [P] [Shared] Create shared Form components in web/src/shared/components/Form/
- [ ] [T237] [P] [Shared] Create Error page in web/src/shared/pages/Error.tsx
- [ ] [T238] [P] [Shared] Create Loading page in web/src/shared/pages/Loading.tsx
- [ ] [T239] [P] [Shared] Create API hooks utility in web/src/shared/hooks/useApi.ts
- [ ] [T240] [P] [Shared] Configure React Router in web/src/App.tsx

### Security & Compliance

- [ ] [T241] [P] [Security] Implement CSP headers in backend/shared/middleware/security.ts
- [ ] [T242] [P] [Security] Configure Helmet.js in API Gateway in backend/services/api-gateway/src/middleware/helmet.ts
- [ ] [T243] [P] [Security] Implement XSS prevention in backend/shared/middleware/xss.ts
- [ ] [T244] [P] [Security] Implement SQL injection prevention in backend/shared/utils/sanitize.ts
- [ ] [T245] [P] [Security] Configure secure session management in backend/shared/middleware/session.ts
- [ ] [T246] [P] [Security] Implement SSL/TLS certificate management in infrastructure/certificates/
- [ ] [T247] [P] [Security] Create HIPAA compliance checklist in docs/compliance/hipaa-checklist.md
- [ ] [T248] [P] [Security] Create GDPR compliance documentation in docs/compliance/gdpr-compliance.md
- [ ] [T249] [S] [Security] Implement security audit logging in backend/shared/utils/securityAudit.ts
- [ ] [T250] [S] [Security] Configure vulnerability scanning in .github/workflows/security-scan.yml

### Monitoring & Observability

- [ ] [T251] [S] [Ops] Configure CloudWatch logging in backend/shared/utils/logger.ts
- [ ] [T252] [S] [Ops] Create Grafana dashboards in infrastructure/monitoring/grafana-dashboards.json
- [ ] [T253] [S] [Ops] Configure Prometheus metrics in backend/shared/middleware/metrics.ts
- [ ] [T254] [S] [Ops] Implement health check endpoints in all services
- [ ] [T255] [S] [Ops] Configure distributed tracing with OpenTelemetry in backend/shared/middleware/tracing.ts
- [ ] [T256] [S] [Ops] Create alerting rules in infrastructure/monitoring/alerts.yml
- [ ] [T257] [S] [Ops] Implement error tracking with Sentry in backend/shared/utils/errorTracking.ts

### Documentation

- [ ] [T258] [S] [Docs] Create API documentation using Swagger UI in backend/services/api-gateway/src/docs/swagger.ts
- [ ] [T259] [S] [Docs] Create developer onboarding guide in docs/onboarding.md
- [ ] [T260] [S] [Docs] Create deployment guide in docs/deployment.md
- [ ] [T261] [S] [Docs] Create troubleshooting guide in docs/troubleshooting.md
- [ ] [T262] [S] [Docs] Create architecture diagrams in docs/architecture/
- [ ] [T263] [C] [Docs] Create user guides for each role in docs/user-guides/

### Performance Optimization

- [ ] [T264] [S] [Perf] Implement Redis caching for frequently accessed data in backend/shared/utils/cache.ts
- [ ] [T265] [S] [Perf] Optimize database queries with proper indexes (see data-model.md)
- [ ] [T266] [S] [Perf] Implement pagination for all list endpoints
- [ ] [T267] [S] [Perf] Configure CDN for static assets in infrastructure/cdn/
- [ ] [T268] [C] [Perf] Implement lazy loading in mobile apps
- [ ] [T269] [C] [Perf] Implement code splitting in web app

### User Experience

- [ ] [T270] [P] [UX] Implement loading states for all async operations
- [ ] [T271] [P] [UX] Implement error messages with user-friendly language
- [ ] [T272] [P] [UX] Implement success notifications
- [ ] [T273] [S] [UX] Implement form validation with real-time feedback
- [ ] [T274] [S] [UX] Implement accessibility features (WCAG 2.1 AA)
- [ ] [T275] [C] [UX] Implement dark mode for mobile apps
- [ ] [T276] [C] [UX] Implement onboarding tutorials for first-time users

---

## Dependency Graph

### Critical Path (Blocking Dependencies)

```
Setup (T001-T026)
  ↓
Database & Migrations (T027-T035)
  ↓
Encryption & Security (T036-T042)
  ↓
Auth Service (T043-T051) + API Gateway (T052-T058)
  ↓
┌─────────────────────────────────┬──────────────────────────┐
│                                 │                          │
User Story 1 (T071-T132)    User Story 2 (T133-T178)  User Story 3 (T179-T221)
Prescription Processing     Teleconsultation           Inventory Management
│                                 │                          │
└─────────────────────────────────┴──────────────────────────┘
  ↓
Polish & Cross-Cutting (T222-T276)
```

### Parallel Execution Opportunities

#### After Auth Service is Complete:

**Parallel Group 1** (can be done simultaneously):
- Prescription Service backend (T077-T095)
- Teleconsultation Service backend (T137-T151)
- Inventory Service backend (T185-T199)

**Parallel Group 2** (can be done simultaneously after Group 1):
- Patient App - Prescription screens (T096-T104)
- Pharmacist App - Prescription screens (T105-T114)
- Doctor App (T122-T128)

**Parallel Group 3** (can be done simultaneously):
- Patient App - Teleconsultation screens (T152-T161)
- Pharmacist App - Teleconsultation screens (T162-T168)
- Web - Teleconsultation pages (T169-T174)

**Parallel Group 4** (can be done simultaneously):
- Pharmacist App - Inventory screens (T200-T209)
- Web - Inventory pages (T210-T217)

**Parallel Group 5** (can be done simultaneously):
- Shared mobile components (T222-T231)
- Shared web components (T232-T240)
- Documentation (T258-T263)

### Dependencies by User Story

#### User Story 1 (Prescription Processing)
**Requires**: Auth Service (T043-T051), Notification Service (T064-T070), Audit Trail (T059-T063)
**Blocks**: Treatment Plan features, Patient Medical Records

#### User Story 2 (Teleconsultation)
**Requires**: Auth Service (T043-T051), Notification Service (T064-T070)
**Optional**: Prescription Service (for creating prescriptions during consultations)

#### User Story 3 (Inventory Management)
**Requires**: Auth Service (T043-T051), Notification Service (T064-T070)
**Optional**: Prescription Service (for linking inventory to prescriptions)

---

## Task Summary

### By Phase
- **Phase 1 (Setup)**: 26 tasks
- **Phase 2 (Foundation)**: 44 tasks
- **Phase 3 (US1 - Prescription)**: 62 tasks
- **Phase 4 (US2 - Teleconsultation)**: 46 tasks
- **Phase 5 (US3 - Inventory)**: 43 tasks
- **Phase 6 (Polish)**: 55 tasks

### By Priority
- **P (Must Have)**: 238 tasks
- **S (Should Have)**: 29 tasks
- **C (Could Have)**: 9 tasks

### By User Story
- **Setup & Foundation**: 70 tasks
- **User Story 1 (P1)**: 62 tasks
- **User Story 2 (P2)**: 46 tasks
- **User Story 3 (P3)**: 43 tasks
- **Shared/Polish**: 55 tasks

**Total Tasks**: 276 tasks

---

## Execution Strategy

### Sprint Planning (2-week sprints)

**Sprint 1-2**: Setup & Foundation (T001-T070)
- Goal: Environment ready, auth working, database migrations complete

**Sprint 3-5**: User Story 1 Backend (T071-T095)
- Goal: Prescription API endpoints complete, tested

**Sprint 6-7**: User Story 1 Mobile (T096-T114)
- Goal: Patient and Pharmacist can upload/review prescriptions

**Sprint 8-9**: User Story 1 Web + Testing (T115-T132)
- Goal: Web portal complete, E2E tests passing

**Sprint 10-12**: User Story 2 (T133-T178)
- Goal: Teleconsultation booking and video calls working

**Sprint 13-15**: User Story 3 (T179-T221)
- Goal: Inventory management with QR scanning complete

**Sprint 16-17**: Polish & Launch Prep (T222-T276)
- Goal: Production-ready with monitoring, docs, compliance

**Total Timeline**: ~34 weeks (~8.5 months) for MVP (P1-P3)

---

## Next Steps

1. ✅ **Tasks Generated**: 276 implementation tasks organized by user story
2. ⏭ **Begin Implementation**: Start with Phase 1 (Setup) tasks T001-T026
3. ⏭ **Parallel Execution**: Once foundation is complete, parallelize user story development
4. ⏭ **Quality Gates**: Run tests after each phase before proceeding to next
5. ⏭ **Track Progress**: Update task checklist as work progresses

**Command to continue**: Tasks complete. Ready to begin implementation with `T001`.
